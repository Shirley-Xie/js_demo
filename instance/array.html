<!DOCTYPE html>
<html>
<head>
    <title>连续数分组</title>
</head>
<body>
  <script type="text/javascript">
 /* //不用递归实现[399, "451-454", "456-458", 460, "469-470", "473-474"]
  var arr = [399,451,452,453,454,456,457,458,460,469,470,473,474];
  var previous = arr[0];
  var group = [];
  // var one = [];
 
  for (var i = 1; i < arr.length; i++){
      var current = arr[i];
      //判断是否是连续数组
      if(previous == current - 1){
        previous = current;
        continue;
      }
      //如果执行完上面的if，则执行
         group.push(previous);
         group.push(current);
     
       //如果不执行上面if，则执行
       // if(a == 0){
        
       // }
     previous = current;      
  }
  group.push(current);
// 最简单数组去重法
function unique(array){
  var n = []; //一个新的临时数组
  //遍历当前数组
  for(var i = 0; i < array.length; i++){
    //如果当前数组的第i已经保存进了临时数组，那么跳过，
    //否则把当前项push到临时数组里面
    if (n.indexOf(array[i]) == -1) n.push(array[i]);
  }
  console.log(n)
  return n;
}
unique(group);
*/
  
/*并没有完成
 //找规律的[399, "451-454", "456-458", 460, "469-470", "473-474"]
 var arr = [399,451,452,453,454,456,457,458,460,469,470,473];
  var previous = arr[0];
  var group = [];
  var one = [];
  var begin,end;

  for (var i = 1; i < arr.length; i++) {
    var current = arr[i];
      
    //判断是否是连续数组
    if(previous == current - 1) {

      if(arr[i-1] != arr[i-2] + 1) {
        begin = arr[i-1];
      }

      if(arr[i] + 1 != arr[i + 1]) {
        end = arr[i];
      }

      previous = current;
      continue;
    }
    
    // 前后不连续
    if(arr[i-1] != arr[i]-1 && arr[i] != arr[i+1]-1) {
      group.push(previous);
    } 
    else {
      // 判断是否为首个值
      if(previous == arr[0]) {
         group.push(current);
      } else{
         group.push(begin + "-" + end);
      }

    }
          
    previous = current;       
  }
  
  group.push( begin + "-" + end );

  console.log(group);
  */

 
// 状态机实现[399, "451-454", "456-458", 460, "469-470", "473-474"]
  var arr = [399,451,452,453,454,456,457,458,460,469,470,473,474];
 function stateMachine(arr){
  var state = state_BEGIN;
  var state_BEGIN = 10;
  var state_CONTINUE = 20;
  var lastVable = null;
  var pair = null;

    for (var i = 0; i < arr.length; i++) {
       currentValue = arr[i];
       currentState = null;
      
      if(lastVable == null){
        currentState = state_BEGIN;
      }else{
          if(lastVable != arr[i] - 1){
            currentState = state_BEGIN;
          }else{
            currentState = state_CONTINUE;
          }
      }
        
      lastVable = currentValue;

       switch(state){
          case state_BEGIN:
              switch(currentState){ 
                    case state_BEGIN:
                        if(pair){
                          if(pair.begin == pair.end){
                              console.log(pair.end);
                          }else{
                              console.log(pair.begin + "-" + pair.end);
                          }
                        }
                        pair = {begin:currentValue,end:currentValue};
                    break;
                    case state_CONTINUE:
                         pair.end = currentValue;
                    break;
              }
              break;
          case state_CONTINUE:
              switch(currentState){ 
                    case state_BEGIN:
                        if(pair.begin == pair.end){
                              console.log(pair.end);
                          }else{
                              console.log(pair.begin + "-" + pair.end);
                          }
                          pair = {begin:currentValue,end:currentValue};
                    break;
                    case state_CONTINUE:
                         pair.end = currentValue;
                    break;
              }
              break;
       }
       state = currentState

    }
    if(pair.end == arr[arr.length - 1]){
        if(pair.begin == pair.end){
            console.log(pair.end);
          }else{
            console.log(pair.begin + "-" + pair.end);
          }
    }
 }
 stateMachine(arr);

  
  
 /* //递归实现[[399],[451,452,453,454],[456,457,458],[460],[469,470],[473,474]]
  var arr = [399,451,452,453,454,456,457,458,460,469,470,473,474];
  //建立数组放分组后的数
  resultArr=[];

  function currentNum(dataValue)
  {
    if (dataValue.length == 0){
      return;
    }
    var tmp = dataValue[0];
   //for循环只是为了找到截取的数量
    for(var i = 1; i < dataValue.length; i++)
    {
      var data = dataValue[i];
      //判断
      if (tmp + 1 == data){
        tmp = data;
      }else{
        break;
      }
    }
     //截取需要的数组
     resultArr.push(dataValue.slice(0,i));
     //调用push后的数组
     currentNum(dataValue.slice(i));
    
  }
  currentNum(arr);
  console.log(resultArr);
*/
/*
//递归实现[399, "451-454", "456-458", 460, "469-470", "473-474"]
 var arr = [399,451,452,453,454,456,457,458,460,469,470,473,474];
  //建立数组放分组后的数
  resultArr=[];

  function currentNum(dataValue)
  {
    var unit = [];
    if (dataValue.length == 0){
      return;
    }
    var tmp = dataValue[0];
   
    for(var i = 1; i < dataValue.length; i++)
    {
      var data = dataValue[i];
      //判断
      if (tmp + 1 == data){
        tmp = data;
      }else{
        break;
      }
    }
    //实现取值后加连接符
    if(i == 1){
      //slice()在已有的数组中返回给定的数字
     resultArr.push(dataValue[0]);
    }else{
      unit.push(dataValue[0],dataValue[i-1]); 
      resultArr.push(unit.join("-"));
    }
     //调用push后的数组
    currentNum(dataValue.slice(i));
    
  }
  currentNum(arr);
  console.log(resultArr);
*/

 

</script>
</body>
</html>
